#begin prematch_green
delay,2000
//initialisation actionneur
propulsion.set_pose,green_start,90
arms.go_to_position$,left,0
arms.go_to_position$,right,0
arms.go_to_position$,grabber,0
arms.go_to_position$,bascule,0
arms.go_to_position$,colonnes,0
//arms.go_to_position$,cubibox,0
delay,1000
propulsion.rotation,90,0
//recallage colonnes
//arms.go_to_position$,rack_colonnes,0
delay,500
propulsion.reposition,180,0
propulsion.trajectory,0,green_reposition_1,green_start
propulsion.rotation,-90,0
propulsion.reposition,-90,1500
propulsion.trajectory,0,green_reposition_2,green_start
delay,1000
#end

#begin prematch_yellow
delay,2000
//#initialisation actionneur
propulsion.set_pose,yellow_start,-90
arms.go_to_position$,left,0
arms.go_to_position$,right,0
arms.go_to_position$,grabber,0
arms.go_to_position$,bascule,0
arms.go_to_position$,colonnes,0
//arms.go_to_position$,cubibox,0
delay,1000
propulsion.rotation,-90,0
//#recallage colonnes
arms.go_to_position$,rack_colonnes,0
delay,500
propulsion.reposition,180,0
propulsion.trajectory,0,yellow_reposition_1,yellow_start
propulsion.rotation,90,0
propulsion.reposition,90,1500
propulsion.trajectory,0,yellow_reposition_2,yellow_start
delay,1000
#end



// Match vert
#begin match_green
arms.execute_sequence$,colonnes,18
//arms.go_to_position$,rack_colonnes,3
delay,300
propulsion.trajectory,0,green_start,green_switch
//declenchement interrupteur
arms.execute_sequence,left,6
propulsion.trajectory,0,green_switch,green_approche_cube_1
propulsion.rotation,-90,0
//preparation prise cube 1
arms.go_to_position$,rack_colonnes,1
arms.execute_sequence$,grabber,14
delay,2000
propulsion.trajectory,1,green_approche_cube_1,green_prise_cube_1
delay,2000
//debut prise cube 1
arms.execute_sequence$,grabber,15
arms.execute_sequence$,left,1
arms.execute_sequence,right,0
arms.execute_sequence,right,4
arms.execute_sequence$,bascule,11
arms.execute_sequence$,right,5
delay,500
arms.execute_sequence,grabber,16
arms.execute_sequence,bascule,11
arms.execute_sequence,left,4
arms.execute_sequence$,bascule,11
arms.execute_sequence,left,5
//fin prise cube 1
//depose cube
//propulsion.trajectory,1,green_prise_cube_1,green_recalage_1
//delay,2000
//arms.execute_sequence,colonnes,19
//delay,2000
//propulsion.trajectory,1,green_recalage_1,green_depose_colonne_1
#end



#begin match_yellow
//#mise en position centrale colonne
arms.go_to_position$,rack_colonnes,2
arms.execute_sequence$,colonnes,18
delay,300
//#declenchement interrupteur
propulsion.trajectory,0,yellow_start,yellow_approche_cube_1
arms.execute_sequence,right,6
propulsion.rotation,93,0

//#preparation prise cube 1
arms.go_to_position$,rack_colonnes,1
arms.execute_sequence$,grabber,14
delay,500
propulsion.trajectory,1,yellow_approche_cube_1,yellow_prise_cube_1
delay,500
//#debut prise cube 1
arms.execute_sequence$,grabber,15
arms.execute_sequence$,left,1
arms.execute_sequence,right,0
arms.execute_sequence,right,4
arms.execute_sequence$,bascule,11
arms.execute_sequence$,right,5
delay,500
arms.execute_sequence,grabber,16
arms.execute_sequence,bascule,11
arms.execute_sequence,left,4
arms.execute_sequence$,bascule,11
arms.execute_sequence,left,5
//#fin prise cube 1

//#preparation prise cube 2
arms.go_to_position,rack_colonnes,3
arms.execute_sequence$,grabber,14
propulsion.rotation,-15,0
delay,500
propulsion.trajectory,1,yellow_prise_cube_1,yellow_approche_cube_2
delay,500
propulsion.rotation,18,0
delay,500
propulsion.trajectory,1,yellow_approche_cube_2,yellow_prise_cube_2
//#debut prise cube 2
arms.execute_sequence$,grabber,15
arms.execute_sequence$,left,1
arms.execute_sequence,right,0
arms.execute_sequence,right,4
arms.execute_sequence$,bascule,11
arms.execute_sequence$,right,5
delay,500
arms.execute_sequence,grabber,16
arms.execute_sequence,bascule,11
arms.execute_sequence,left,4
arms.execute_sequence$,bascule,11
arms.execute_sequence,left,5
//#fin prise cube 2

//#preparation prise cube 3
arms.go_to_position,rack_colonnes,2
arms.execute_sequence$,grabber,14
propulsion.rotation,105,0
delay,500
propulsion.trajectory,1,yellow_prise_cube_2,yellow_approche_cube_3
delay,500
propulsion.rotation,-10,0
delay,500
propulsion.trajectory,1,yellow_approche_cube_3,yellow_prise_cube_3
//#debut prise cube 3
arms.execute_sequence$,grabber,15
arms.execute_sequence$,left,1
arms.execute_sequence,right,0
arms.execute_sequence,right,4
arms.execute_sequence$,bascule,11
arms.execute_sequence$,right,5
delay,500
arms.execute_sequence,grabber,16
arms.execute_sequence,bascule,11
arms.execute_sequence,left,4
arms.execute_sequence$,bascule,11
arms.execute_sequence,left,5
//#fin prise cube 3

//#deplacement_depose
propulsion.rotation,-85,0
delay,500
propulsion.trajectory,1,yellow_prise_cube_3,yellow_depose_colonne_2
delay,500
arms.execute_sequence,colonnes,19
delay,1000
propulsion.trajectory,1,yellow_depose_colonne_2,yellow_degage_colonne_2
#end



#begin prise2
arms.execute_sequence$,grabber,14
delay,1000
propulsion.rotation,-15,0
delay,1000
propulsion.trajectory,1,yellow_prise_cube_1,yellow_approche_cube_2
delay,1000
propulsion.rotation,18,0
delay,1000
propulsion.trajectory,1,yellow_approche_cube_2,yellow_prise_cube_2
#end

#begin prise3
arms.execute_sequence$,grabber,14
delay,500
propulsion.rotation,105,0
delay,500
propulsion.trajectory,1,yellow_prise_cube_2,yellow_approche_cube_3
delay,500
propulsion.rotation,-10,0
delay,500
propulsion.trajectory,1,yellow_approche_cube_3,yellow_prise_cube_3
#end

#begin depose_post-cube_1
propulsion.trajectory,1,yellow_prise_cube_1,yellow_depose_colonne_1
delay,1000
arms.execute_sequence,colonnes,19
delay,2000
propulsion.trajectory,1,yellow_depose_colonne_1,yellow_degage_colonne_1
#end

#begin depose_post-cube_2
propulsion.rotation,-15,0
delay,500
propulsion.trajectory,1,yellow_prise_cube_2,yellow_prise_cube_1
delay,500
propulsion.trajectory,1,yellow_prise_cube_1,yellow_depose_colonne_1
delay,2000
arms.execute_sequence,colonnes,19
delay,2000
propulsion.trajectory,1,yellow_depose_colonne_1,yellow_degage_colonne_1
#end

#begin depose_post-cube_3
propulsion.rotation,-85,0
delay,500
propulsion.trajectory,1,yellow_prise_cube_3,yellow_depose_colonne_2
delay,500
arms.execute_sequence,colonnes,19
delay,1000
propulsion.trajectory,1,yellow_depose_colonne_2,yellow_degage_colonne_2
#end

#begin prise1_Gdiag_Ddroit
arms.execute_sequence,colonnes,18
arms.execute_sequence$,grabber,15
arms.execute_sequence$,left,1
arms.execute_sequence,right,0
arms.execute_sequence,right,4
arms.execute_sequence$,bascule,11
arms.execute_sequence$,right,5
delay,500
arms.execute_sequence,grabber,16
arms.execute_sequence,bascule,11
arms.execute_sequence,left,4
arms.execute_sequence$,bascule,11
arms.execute_sequence,left,5
delay,2000
//arms.execute_sequence,colonnes,19
#end

#begin init_arms
arms.go_to_position$,left,0
arms.go_to_position$,right,0
arms.go_to_position$,grabber,0
arms.go_to_position$,bascule,0
//arms.go_to_position$,colonnes,0
arms.execute_sequence,colonnes,18
//arms.go_to_position$,cubibox,0
#end

#begin TEST_bascule
arms.execute_sequence,bascule,11
#end

#begin TEST_col_portes
arms.execute_sequence,colonnes,18
delay,1500
arms.execute_sequence,colonnes,19
delay,200
#end

#begin TEST_col_tassage
arms.go_to_position,rack_colonnes,1
delay,150
arms.go_to_position,rack_colonnes,3
delay,300
arms.go_to_position,rack_colonnes,1
delay,300
arms.go_to_position,rack_colonnes,3
delay,230
arms.go_to_position,rack_colonnes,1
delay,150
arms.go_to_position$,rack_colonnes,2
#end

#begin TEST_prise_pince
arms.execute_sequence,grabber,13
delay,500
arms.execute_sequence,grabber,14
delay,3000
//placer le cube maintenant
arms.execute_sequence,grabber,15
delay,500
arms.execute_sequence,grabber,16
#end

#begin calibrate_odometry
propulsion.set_pose,calibration_reposition,0
propulsion.reposition,0,170
propulsion.trajectory,0,calibration_reposition,calibration_origin
#end

#begin calibrate_odometry
propulsion.trajectory,0,calibration_origin,calibration_reposition
propulsion.reposition,0,170
propulsion.trajectory,0,calibration_reposition,calibration_origin
#end

#begin calibrate_odometry_cw
propulsion.rotation,-1800
#end

#begin calibrate_odometry_ccw
propulsion.rotation,1800
#end

#begin calibrate_colonnes
arms.go_to_position$,rack_colonnes,0
arms.go_to_position$,rack_colonnes,2
#end

//7 traversee de table pour voir la rectitude
#begin traverser_table
propulsion.set_pose,calibration_reposition,0
propulsion.reposition,0,170
propulsion.trajectory,0,calibration_reposition,calibration_origin
propulsion.rotation,-180
propulsion.trajectory,0,calibration_origin,p_bout
#end
